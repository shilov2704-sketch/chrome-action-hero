<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QA Test Recorder</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="panel.css">
</head>
<body>
  <div id="app">
    <!-- Main View -->
    <div id="mainView" class="view active">
      <div class="header">
        <h1>üé¨ QA Test Recorder</h1>
        <div class="header-actions">
          <label class="theme-switcher" for="themeSelect">
            <span class="theme-label">–¢–µ–º–∞</span>
            <select id="themeSelect" class="input theme-select">
              <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
              <option value="dark">–¢—ë–º–Ω–∞—è</option>
            </select>
          </label>
          <div class="import-dropdown">
            <button id="importRecordingBtn" class="btn btn-secondary">
              <span class="icon">üì•</span> –ò–º–ø–æ—Ä—Ç
            </button>
            <div class="import-dropdown-menu" id="importDropdownMenu">
              <button class="import-option" id="importRecordingOption">üìÑ –ó–∞–ø–∏—Å—å (JSON)</button>
              <button class="import-option" id="importFolderOption">üìÅ –ü–∞–ø–∫–∞ (ZIP)</button>
            </div>
          </div>
          <input type="file" id="importFileInput" accept=".json,.JSON,application/json" style="display: none;" multiple>
          <input type="file" id="importFolderInput" accept=".zip,.ZIP,application/zip,application/x-zip-compressed" style="display: none;">
          <button id="createFolderBtn" class="btn btn-secondary">
            <span class="icon">üìÅ</span> –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
          </button>
          <button id="createRecordingBtn" class="btn btn-primary">
            <span class="icon">‚ûï</span> –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å
          </button>
        </div>
      </div>

      <!-- Bulk Actions Bar -->
      <div class="bulk-actions-bar" id="bulkActionsBar" style="display: none;">
        <span class="bulk-count" id="bulkCount">0 –≤—ã–±—Ä–∞–Ω–æ</span>
        <button class="btn btn-secondary" id="bulkSelectAllBtn">
          <span class="icon">‚òëÔ∏è</span> –í—ã–±—Ä–∞—Ç—å –≤—Å–µ
        </button>
        <button class="btn btn-secondary" id="bulkExportBtn">
          <span class="icon">üì§</span> –≠–∫—Å–ø–æ—Ä—Ç
        </button>
        <button class="btn btn-danger" id="bulkDeleteBtn">
          <span class="icon">üóë</span> –£–¥–∞–ª–∏—Ç—å
        </button>
        <button class="btn btn-ghost" id="bulkCancelBtn">–û—Ç–º–µ–Ω–∞</button>
      </div>
      
      <!-- Reset Results Bar -->
      <div class="reset-results-bar" id="resetResultsBar">
        <button class="btn btn-secondary" id="resetResultsBtn" style="display: none;">
          <span class="icon">üîÑ</span> –°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
        </button>
      </div>
      
      <!-- Folder Playback Notification -->
      <div class="folder-playback-bar" id="folderPlaybackBar" style="display: none;">
        <span class="folder-playback-icon">‚ñ∂Ô∏è</span>
        <span class="folder-playback-text" id="folderPlaybackText">–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ...</span>
        <span class="folder-playback-progress" id="folderPlaybackProgress">0/0</span>
      </div>

      <!-- Search Bar -->
      <div class="search-bar">
        <input type="text" id="searchInput" class="input search-input" placeholder="üîç –ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–µ–π –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é...">
        <button id="clearSearchBtn" class="btn btn-ghost btn-small clear-search-btn" style="display: none;">‚úï</button>
      </div>

      <div class="recordings-list" id="recordingsList">
        <div class="empty-state">
          <div class="empty-icon">üìπ</div>
          <h2>–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</h2>
          <p>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–ø–∏—Å—å –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã</p>
        </div>
      </div>
    </div>

    <!-- Create Recording View -->
    <div id="createView" class="view">
      <div class="header">
        <button id="backToMainBtn" class="btn btn-ghost">
          <span class="icon">‚Üê</span> –ù–∞–∑–∞–¥
        </button>
        <h1>–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å</h1>
      </div>

      <div class="form-container">
        <div class="form-group">
          <label for="recordingName">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏</label>
          <input type="text" id="recordingName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏" class="input">
        </div>

        <div class="form-group">
          <label for="suiteName">–ù–∞–∑–≤–∞–Ω–∏–µ TestSuite</label>
          <select id="suiteName" class="input">
            <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ TestSuite --</option>
            <option value="–í—Å–µ –∑–∞—è–≤–∫–∏">–í—Å–µ –∑–∞—è–≤–∫–∏</option>
            <option value="–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫</option>
            <option value="–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞">–ú–∞—Ä–∫–∏—Ä–æ–≤–∫–∞</option>
            <option value="–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç</option>
            <option value="–û–±—ä–µ–∫—Ç—ã/–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ">–û–±—ä–µ–∫—Ç—ã/–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</option>
            <option value="–®–∞–±–ª–æ–Ω –û–±—ä–µ–∫—Ç–æ–≤/–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è">–®–∞–±–ª–æ–Ω –û–±—ä–µ–∫—Ç–æ–≤/–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</option>
            <option value="–ó–∞–∫–∞–∑—á–∏–∫–∏">–ó–∞–∫–∞–∑—á–∏–∫–∏</option>
            <option value="–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</option>
            <option value="–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</option>
            <option value="–í—Å–µ –∫–æ–º–ø–∞–Ω–∏–∏">–í—Å–µ –∫–æ–º–ø–∞–Ω–∏–∏</option>
            <option value="–î–æ–≥–æ–≤–æ—Ä—ã">–î–æ–≥–æ–≤–æ—Ä—ã</option>
            <option value="–°–æ–æ–±—â–µ–Ω–∏—è">–°–æ–æ–±—â–µ–Ω–∏—è</option>
            <option value="–®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π">–®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π</option>
            <option value="–ß–µ–∫-–ª–∏—Å—Ç—ã">–ß–µ–∫-–ª–∏—Å—Ç—ã</option>
            <option value="–°–∫–ª–∞–¥—ã">–°–∫–ª–∞–¥—ã</option>
            <option value="–ú–∞—Ç–µ—Ä–∏–∞–ª—ã">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</option>
            <option value="–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ">–û—Å—Ç–∞—Ç–∫–∏ –Ω–∞ —Å–∫–ª–∞–¥–µ</option>
            <option value="–†–∞—Å—Ö–æ–¥">–†–∞—Å—Ö–æ–¥</option>
        </select>
        </div>

        <div class="form-group">
          <label for="workItemId">WorkItemID –≤ Azure (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
          <input type="text" id="workItemId" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ ID —Ä–∞–±–æ—á–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞" pattern="[0-9]*" inputmode="numeric">
        </div>

        <div class="form-group">
          <label for="preconditions">–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
          <textarea id="preconditions" class="input preconditions-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞..." rows="3"></textarea>
        </div>

        <div class="form-group">
          <label>–¢–∏–ø—ã —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤</label>
          <div class="checkbox-group">
            <label class="checkbox-label">
              <input type="checkbox" id="selectorCSS" value="css" checked>
              <span>CSS</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="selectorARIA" value="aria">
              <span>ARIA</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="selectorText" value="text">
              <span>Text</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="selectorXPath" value="xpath" checked>
              <span>XPath</span>
            </label>
            <label class="checkbox-label">
              <input type="checkbox" id="selectorPierce" value="pierce">
              <span>Pierce</span>
            </label>
          </div>
        </div>

        <button id="startRecordingBtn" class="btn btn-primary btn-large">
          <span class="icon">‚è∫</span> –ù–∞—á–∞—Ç—å –∑–∞–ø–∏—Å—å
        </button>
      </div>
    </div>

    <!-- Recording View -->
    <div id="recordingView" class="view">
      <div class="header">
        <div class="header-left">
          <h1 id="currentRecordingName">–ó–∞–ø–∏—Å—å...</h1>
          <div class="recording-indicator">
            <span class="recording-dot"></span>
            <span>–ò–¥–µ—Ç –∑–∞–ø–∏—Å—å</span>
          </div>
        </div>
        <div class="header-actions">
          <button id="stopRecordingBtn" class="btn btn-danger">
            <span class="icon">‚èπ</span> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
          </button>
        </div>
      </div>

      <div class="recording-content">
        <div class="steps-panel">
          <div class="steps-header">
            <h3>–®–∞–≥–∏</h3>
            <button id="addAssertionBtn" class="btn btn-small">
              <span class="icon">‚ûï</span> Add Assertion
            </button>
          </div>
          <div id="stepsList" class="steps-list"></div>
        </div>

        <div class="details-panel">
          <div class="panel-tabs">
            <button class="tab-btn active" data-tab="details">–î–µ—Ç–∞–ª–∏</button>
            <button class="tab-btn" data-tab="settings">Replay Settings</button>
            <button class="tab-btn" data-tab="code">Show Code</button>
          </div>

          <div id="detailsTab" class="tab-content active">
            <div id="stepDetails" class="step-details-empty">
              <p>–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π</p>
            </div>
          </div>

          <div id="settingsTab" class="tab-content">
            <div class="form-group">
              <label for="throttling">Throttling</label>
              <select id="throttling" class="input">
                <option value="none">None</option>
                <option value="slow-3g">Slow 3G</option>
                <option value="fast-3g">Fast 3G</option>
              </select>
            </div>
            <div class="form-group">
              <label for="timeout">Timeout (ms)</label>
              <input type="number" id="timeout" class="input" min="5000" max="30000" value="5000" step="1000">
            </div>
          </div>

          <div id="codeTab" class="tab-content">
            <pre id="codePreview" class="code-preview"></pre>
          </div>
        </div>
      </div>
    </div>

    <!-- Playback View -->
    <div id="playbackView" class="view">
      <div class="header">
        <button id="backToMainFromPlaybackBtn" class="btn btn-ghost">
          <span class="icon">‚Üê</span> –ù–∞–∑–∞–¥
        </button>
        <h1 id="playbackRecordingName" class="editable-title" title="–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å">–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ</h1>
        <button id="renameRecordingBtn" class="btn btn-ghost btn-small" title="–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å">
          <span class="icon">‚úèÔ∏è</span>
        </button>
        <div class="header-actions">
          <button id="continueRecordingBtn" class="btn btn-primary">
            <span class="icon">‚è∫</span> –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∑–∞–ø–∏—Å—å
          </button>
          <select id="replaySpeed" class="input" style="width: auto; margin-right: 10px;">
            <option value="normal">Normal Speed</option>
            <option value="slow">Slow</option>
          </select>
          <input type="number" id="replayTimeout" class="input" min="5000" max="30000" value="5000" step="1000" 
                 placeholder="Timeout (ms)" style="width: 120px; margin-right: 10px;" title="Timeout –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ (5000-30000 –º—Å)">
          <button id="replayBtn" class="btn btn-primary">
            <span class="icon">‚ñ∂Ô∏è</span> Replay
          </button>
          <button id="stopReplayBtn" class="btn btn-danger" style="display: none;">
            <span class="icon">‚èπ</span> Stop Replay
          </button>
          <button id="resetPlaybackResultsBtn" class="btn btn-secondary" style="display: none;">
            <span class="icon">üîÑ</span> –°–±—Ä–æ—Å–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
          </button>
          <button id="exportJsonBtn" class="btn btn-secondary">
            <span class="icon">üíæ</span> –≠–∫—Å–ø–æ—Ä—Ç JSON
          </button>
          <button id="deleteRecordingBtn" class="btn btn-danger">
            <span class="icon">üóë</span> –£–¥–∞–ª–∏—Ç—å
          </button>
        </div>
      </div>

      <div class="recording-content">
        <div class="steps-panel">
          <div class="steps-header">
            <h3>–®–∞–≥–∏ –∑–∞–ø–∏—Å–∏</h3>
            <button id="playbackAddAssertionBtn" class="btn btn-small">
              <span class="icon">‚ûï</span> Add Assertion
            </button>
          </div>
          <div id="playbackStepsList" class="steps-list"></div>
        </div>

        <div class="details-panel">
          <div class="panel-tabs">
            <button class="tab-btn active" data-tab="playbackDetails">–î–µ—Ç–∞–ª–∏</button>
            <button class="tab-btn" data-tab="playbackSettings">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="tab-btn" data-tab="playbackCode">Show Code</button>
          </div>

          <div id="playbackDetailsTab" class="tab-content active">
            <div id="playbackStepDetails" class="step-details-empty">
              <p>–í—ã–±–µ—Ä–∏—Ç–µ —à–∞–≥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π</p>
            </div>
          </div>

          <div id="playbackSettingsTab" class="tab-content">
            <div class="settings-section">
              <h4>WorkItemID –≤ Azure</h4>
              <p class="settings-description">ID —Ä–∞–±–æ—á–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ Azure DevOps</p>
              <div class="workitem-edit-container">
                <input type="text" id="editWorkItemId" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ ID..." pattern="[0-9]*" inputmode="numeric">
                <button id="saveWorkItemIdBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </div>
            </div>
            
            <div class="settings-section">
              <h4>–ü—Ä–µ–¥—É—Å–ª–æ–≤–∏—è</h4>
              <p class="settings-description">–û–ø–∏—à–∏—Ç–µ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–∞</p>
              <div class="preconditions-edit-container">
                <textarea id="editPreconditions" class="input preconditions-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥—É—Å–ª–æ–≤–∏—è..." rows="3"></textarea>
                <button id="savePreconditionsBtn" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </div>
            </div>
            
            <div class="settings-section">
              <h4>–ó–∞–º–µ–Ω–∏—Ç—å Host</h4>
              <p class="settings-description">–ó–∞–º–µ–Ω–∏—Ç–µ —Ö–æ—Å—Ç –≤–æ –≤—Å–µ—Ö URL –∑–∞–ø–∏—Å–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å dev –Ω–∞ staging)</p>
              <div class="host-replace-container">
                <input type="text" id="newHostInput" class="input" placeholder="https://new-host.example.com">
                <button id="applyHostBtn" class="btn btn-primary">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
              </div>
              <div id="currentHostInfo" class="current-host-info"></div>
            </div>
          </div>

          <div id="playbackCodeTab" class="tab-content">
            <pre id="playbackCodePreview" class="code-preview"></pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="lib/fflate.min.js"></script>
  <script src="panel.js"></script>
</body>
</html>
